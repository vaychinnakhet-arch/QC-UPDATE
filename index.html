<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ตาราง UPDATE งาน</title>
  <link rel="stylesheet" href="index.css">
  <link rel="preconnect" href="httpshttps://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
  <!-- ExcelJS library for export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="header-info">
        <p>Up date</p>
        <p>5 ก.ย. 67</p>
      </div>
      <div class="header-title">
        <h1>ตาราง UPDATE งาน เหนือผ้า & QC WW & QC End</h1>
        <p>VAY CHINNAKHET</p>
      </div>
      <div class="header-actions">
        <div class="action-buttons">
          <button id="import-json-btn" class="action-button import">Import JSON</button>
          <input type="file" id="import-json-input" accept=".json" style="display: none;">
          <button id="export-json-btn" class="action-button export-json">Export JSON</button>
          <button id="export-excel-btn" class="action-button export-excel">Export to Excel</button>
        </div>
        <div class="status-container">
            Status: <span id="status-indicator"></span>
        </div>
      </div>
    </header>

    <div class="table-wrapper">
      <table id="main-schedule-table">
        <thead>
          <tr class="header-main">
            <th rowspan="2" class="static-col-1">ชั้น</th>
            <th colspan="2" class="th-neua-fa">เหนือผ้า</th>
            <th colspan="2" class="th-qc-ww">QC WW</th>
            <th colspan="2" class="th-qc-end">QC End</th>
            <th rowspan="2"></th> <!-- Empty header for Plan/Actual column -->
            <th colspan="2">ก.ย.</th>
            <th colspan="4">ต.ค.</th>
            <th colspan="5">พ.ย.</th>
            <th colspan="5">ธ.ค.</th>
            <th rowspan="2">หมายเหตุ</th>
          </tr>
          <tr class="header-sub">
            <th class="th-neua-fa">ทั้งหมด</th>
            <th class="th-neua-fa">ส่ง</th>
            <th class="th-qc-ww">ทั้งหมด</th>
            <th class="th-qc-ww">ส่ง</th>
            <th class="th-qc-end">ทั้งหมด</th>
            <th class="th-qc-end">ส่ง</th>
            <!-- Week headers will be used to map indices -->
            <th>15-21</th> <!-- 0 -->
            <th>22-28</th> <!-- 1 -->
            <th>29-5</th>  <!-- 2 -->
            <th>6-12</th>  <!-- 3 -->
            <th>13-19</th> <!-- 4 -->
            <th>20-26</th> <!-- 5 -->
            <th>27-2</th>  <!-- 6 -->
            <th>3-9</th>   <!-- 7 -->
            <th>10-16</th> <!-- 8 -->
            <th>17-23</th> <!-- 9 -->
            <th>24-30</th> <!-- 10 -->
            <th>1-7</th>   <!-- 11 -->
            <th>8-14</th>  <!-- 12 -->
            <th>15-21</th> <!-- 13 -->
            <th>22-28</th> <!-- 14 -->
            <th>29-30</th> <!-- 15 -->
          </tr>
        </thead>
        <tbody>
          <!-- Rows will be generated by script -->
        </tbody>
        <tfoot>
          <tr>
            <th>รวม</th>
            <td id="total-neua-fa-plan"></td>
            <td id="total-neua-fa-sent"></td>
            <td id="total-qc-ww-plan"></td>
            <td id="total-qc-ww-sent"></td>
            <td id="total-qc-end-plan"></td>
            <td id="total-qc-end-sent"></td>
            <td colspan="18"></td> <!-- Span across Plan/Actual, 16 weeks, and Note columns -->
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="summary-tables-container">
      <div class="table-wrapper">
        <table id="summary-neua-fa" class="summary-table">
          <!-- Populated by script -->
        </table>
      </div>
      <div class="table-wrapper">
        <table id="summary-qc-ww" class="summary-table">
          <!-- Populated by script -->
        </table>
      </div>
      <div class="table-wrapper">
        <table id="summary-qc-end" class="summary-table">
          <!-- Populated by script -->
        </table>
      </div>
    </div>

  </div>

  <!-- Popover for editing cells -->
  <div id="popover" class="popover" style="display: none;">
    <input type="number" id="popover-input" min="0" class="popover-input">
    <div class="popover-actions">
        <button data-task="neua-fa" class="popover-button">เหนือผ้า</button>
        <button data-task="qc-ww" class="popover-button">QC WW</button>
        <button data-task="qc-end" class="popover-button">QC End</button>
    </div>
    <div class="popover-controls">
        <button id="popover-clear">Clear</button>
        <button id="popover-cancel">Cancel</button>
    </div>
  </div>


  <script type="module" src="index.js"></script>
</body>

</html>