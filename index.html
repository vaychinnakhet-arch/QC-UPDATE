
<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ตาราง UPDATE งาน</title>
  <link rel="stylesheet" href="index.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
  <!-- Third-party libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="header-info">
        <p>Up date</p>
        <p>5 ก.ย. 67</p>
      </div>
      <div class="header-title">
        <h1>ตาราง UPDATE งาน เหนือผ้า & QC WW & QC End</h1>
        <p>VAY CHINNAKHET</p>
      </div>
      <div class="header-actions">
        <div id="supabase-warning" style="display: none; color: orange; font-size: 12px; text-align: right; margin-bottom: 4px;">
          Supabase not configured. Data is local only.
        </div>
        <div class="action-buttons">
          <button id="capture-btn" class="action-button capture">เเคปเจอร์ภาพ</button>
          <button id="import-json-btn" class="action-button import">Import JSON</button>
          <input type="file" id="import-json-input" accept=".json" style="display: none;">
          <button id="export-json-btn" class="action-button export-json">Export JSON</button>
          <button id="export-excel-btn" class="action-button export-excel">Export to Excel</button>
        </div>
        <div class="status-container">
            Status: <span id="status-indicator"></span>
        </div>
      </div>
    </header>

    <div class="table-wrapper">
      <table id="main-schedule-table">
        <thead>
          <!-- Headers will be generated by script -->
        </thead>
        <tbody>
          <!-- Rows will be generated by script -->
        </tbody>
        <tfoot>
          <tr>
            <th>รวม</th>
            <td id="total-neua-fa-plan"></td>
            <td id="total-neua-fa-sent"></td>
            <td id="total-qc-ww-plan"></td>
            <td id="total-qc-ww-sent"></td>
            <td id="total-qc-end-plan"></td>
            <td id="total-qc-end-sent"></td>
            <td colspan="18"></td> <!-- Span will be updated by JS -->
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="summary-tables-container">
      <div class="table-wrapper">
        <table id="summary-neua-fa" class="summary-table">
          <!-- Populated by script -->
        </table>
      </div>
      <div class="table-wrapper">
        <table id="summary-qc-ww" class="summary-table">
          <!-- Populated by script -->
        </table>
      </div>
      <div class="table-wrapper">
        <table id="summary-qc-end" class="summary-table">
          <!-- Populated by script -->
        </table>
      </div>
    </div>

  </div>

  <!-- Popover for editing cells -->
  <div id="popover" class="popover" style="display: none;">
    <input type="number" id="popover-input" min="0" class="popover-input">
    <div class="popover-actions">
        <button data-task="neua-fa" class="popover-button">เหนือผ้า</button>
        <button data-task="qc-ww" class="popover-button">QC WW</button>
        <button data-task="qc-end" class="popover-button">QC End</button>
    </div>
    <div class="popover-controls">
        <button id="popover-clear">Clear</button>
        <button id="popover-cancel">Cancel</button>
    </div>
  </div>


  <script type="module" src="index.js"></script>
</body>

</html>
